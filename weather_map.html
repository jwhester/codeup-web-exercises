<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map Project</title>
    <link rel="stylesheet" href="css/weather.css">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css' rel='stylesheet' />
</head>
<body>
<div id="cards">
<div id="card"></div>
<div id="card2"></div>
<div id="card3"></div>
</div>
<div id='map'></div>
<script src="js/keys.js"></script>
<!--<script src="js/mapbox-geocoder-utils.js"></script>-->
<script src="js/mapbox_maps_api.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        "use strict";
        var monthNames = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"
        ];
        var d = new Date();
        var month = monthNames[d.getMonth()];
        var day = d.getDate();
        var tomorrowSet = d.getDate()+1;
        var dayAfterTomorrowSet = d.getDate()+2;
        var today = (month<10 ? '0' : '') + month + ' ' +(day<10 ? '0' : '') + day + ', ' + d.getFullYear();
        var tomorrow = (month<10 ? '0' : '') + month + ' ' +(tomorrowSet<10 ? '0' : '') + tomorrowSet + ', ' + d.getFullYear();
        var dayAfterTomorrow = (month<10 ? '0' : '') + month + ' ' +(dayAfterTomorrowSet<10 ? '0' : '') + dayAfterTomorrowSet + ', ' + d.getFullYear();



        var weather = $.get("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/" + darkSky + "/29.4241,-98.4936");
        console.log(weather.done());

        function genWeatherToday() {
            weather.done(function (data) {
                var content = "<h6>";
                content += today;
                content += "</h6>";
                content += "<h3 class='temp'>";
                content += Math.round(data.currently.temperature) + "F";
                content += "</h3>";
                content += "<img class='icon1'>";
                content += "<h5 class='humidity'>";
                content += "Humidity: " + Math.round(data.currently.humidity * 100) + "%";
                content += "</h5>";
                content += "<h5 class='windSpeed'>";
                content += "Wind Speed: " + Math.round(data.currently.windSpeed) + " MPH" ;
                content += "</h5>";
                content += "<h5 class='pressure'>";
                content += "Pressure: " + data.currently.pressure;
                content += "</h5>";

                $('#card').append(content);
                var icons = [
                    {
                        summary: "clear-day",
                        image: 'icons/clearDay.png'
                    },
                    {
                        summary: "clear-night",
                        image: 'icons/clearNight.png'
                    },
                    {
                        summary: "rain",
                        image: 'icons/rain.png'
                    },
                    {
                        summary: "snow",
                        image: 'icons/snow.png'
                    },
                    {
                        summary: "sleet",
                        image: 'icons/sleet.png'
                    },
                    {
                        summary: "wind",
                        image: 'icons/wind.png'
                    },
                    {
                        summary: "fog",
                        image: 'icons/fog.png'
                    },
                    {
                        summary: "cloudy",
                        image: 'icons/cloudy.png'
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: 'icons/partlyCloudyDay.png'
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: 'icons/partlyCloudyNight.png'
                    },

                ];
                var backgrounds = [
                    {
                        summary: "clear-day",
                        image: "url('icons/clearDay.gif')"
                    },
                    {
                        summary: "clear-night",
                        image: "url('icons/clearNight.gif')"
                    },
                    {
                        summary: "rain",
                        image: "url('icons/rain.gif')"
                    },
                    {
                        summary: "snow",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "sleet",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "wind",
                        image: "url('icons/wind.gif')"
                    },
                    {
                        summary: "fog",
                        image: "url('icons/fog.gif')"
                    },
                    {
                        summary: "cloudy",
                        image: "url('icons/cloudy.gif')"
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: "url('icons/partlyCloudyDay.gif')"
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: "url('icons/partlyCloudyNight.gif')"
                    },

                ];
                icons.forEach(function (type) {
                    if(data.currently.icon === type.summary){
                        $('.icon1').attr('src',type.image);
                    }
                });
                backgrounds.forEach(function (type) {
                    if(data.currently.icon === type.summary){
                        $('#card').css('background-image',type.image);
                    }
                });
            });
            weather.fail(function () {
                console.log("try again")
            })
        }





        function genWeatherTomorrow() {
            weather.done(function (data) {
                var content = "<h6>";
                content += tomorrow;
                content += "</h6>";
                content += "<h3 class='temp'>";
                content += "Low: " + Math.round(data.daily.data[1].temperatureMin) + "F";
                content += "</h3>";
                content += "<h3 class='temp'>";
                content += "High: " + Math.round(data.daily.data[1].temperatureMax) + "F";
                content += "</h3>";
                content += "<img class='icon2'>";
                content += "<h5 class='humidity'>";
                content += "Humidity: " + Math.round(data.daily.data[1].humidity * 100) + "%";
                content += "</h5>";
                content += "<h5 class='windSpeed'>";
                content += "Wind Speed: " + Math.round(data.daily.data[1].windSpeed) + " MPH" ;
                content += "</h5>";
                content += "<h5 class='pressure'>";
                content += "Pressure: " + data.daily.data[1].pressure;
                content += "</h5>";

                $('#card2').append(content);
                var icons = [
                    {
                        summary: "clear-day",
                        image: 'icons/clearDay.png'
                    },
                    {
                        summary: "clear-night",
                        image: 'icons/clearNight.png'
                    },
                    {
                        summary: "rain",
                        image: 'icons/rain.png'
                    },
                    {
                        summary: "snow",
                        image: 'icons/snow.png'
                    },
                    {
                        summary: "sleet",
                        image: 'icons/sleet.png'
                    },
                    {
                        summary: "wind",
                        image: 'icons/wind.png'
                    },
                    {
                        summary: "fog",
                        image: 'icons/fog.png'
                    },
                    {
                        summary: "cloudy",
                        image: 'icons/cloudy.png'
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: 'icons/partlyCloudyDay.png'
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: 'icons/partlyCloudyNight.png'
                    },

                ];
                var backgrounds = [
                    {
                        summary: "clear-day",
                        image: "url('icons/clearDay.gif')"
                    },
                    {
                        summary: "clear-night",
                        image: "url('icons/clearNight.gif')"
                    },
                    {
                        summary: "rain",
                        image: "url('icons/rain.gif')"
                    },
                    {
                        summary: "snow",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "sleet",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "wind",
                        image: "url('icons/wind.gif')"
                    },
                    {
                        summary: "fog",
                        image: "url('icons/fog.gif')"
                    },
                    {
                        summary: "cloudy",
                        image: "url('icons/cloudy.gif')"
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: "url('icons/partlyCloudyDay.gif')"
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: "url('icons/partlyCloudyNight.gif')"
                    },

                ];
                icons.forEach(function (type) {
                    if(data.daily.data[1].icon === type.summary){
                        $('.icon2').attr('src',type.image);
                    }
                });
                backgrounds.forEach(function (type) {
                    if(data.daily.data[1].icon === type.summary){
                        $('#card2').css('background-image',type.image);
                    }
                });
            });
            weather.fail(function () {
                console.log("try again")
            })
        }










        function genWeatherDayAfterTomorrow() {
            weather.done(function (data) {
                var content = "<h5>";
                content += dayAfterTomorrow;
                content += "</h5>";
                content += "<h3 class='temp'>";
                content += "Low: " + Math.round(data.daily.data[2].temperatureMin) + "F";
                content += "</h3>";
                content += "<h3 class='temp'>";
                content += "High: " + Math.round(data.daily.data[2].temperatureMax) + "F";
                content += "</h3>";
                content += "<img class='icon3'>";
                content += "<h5 class='humidity'>";
                content += "Humidity: " + Math.round(data.daily.data[2].humidity * 100) + "%";
                content += "</h5>";
                content += "<h5 class='windSpeed'>";
                content += "Wind Speed: " + Math.round(data.daily.data[2].windSpeed) + " MPH" ;
                content += "</h5>";
                content += "<h5 class='pressure'>";
                content += "Pressure: " + data.daily.data[2].pressure;
                content += "</h5>";

                $('#card3').append(content);
                var icons = [
                    {
                        summary: "clear-day",
                        image: 'icons/clearDay.png'
                    },
                    {
                        summary: "clear-night",
                        image: 'icons/clearNight.png'
                    },
                    {
                        summary: "rain",
                        image: 'icons/rain.png'
                    },
                    {
                        summary: "snow",
                        image: 'icons/snow.png'
                    },
                    {
                        summary: "sleet",
                        image: 'icons/sleet.png'
                    },
                    {
                        summary: "wind",
                        image: 'icons/wind.png'
                    },
                    {
                        summary: "fog",
                        image: 'icons/fog.png'
                    },
                    {
                        summary: "cloudy",
                        image: 'icons/cloudy.png'
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: 'icons/partlyCloudyDay.png'
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: 'icons/partlyCloudyNight.png'
                    },

                ];
                var backgrounds = [
                    {
                        summary: "clear-day",
                        image: "url('icons/clearDay.gif')"
                    },
                    {
                        summary: "clear-night",
                        image: "url('icons/clearNight.gif')"
                    },
                    {
                        summary: "rain",
                        image: "url('icons/rain.gif')"
                    },
                    {
                        summary: "snow",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "sleet",
                        image: "url('icons/snow.gif')"
                    },
                    {
                        summary: "wind",
                        image: "url('icons/wind.gif')"
                    },
                    {
                        summary: "fog",
                        image: "url('icons/fog.gif')"
                    },
                    {
                        summary: "cloudy",
                        image: "url('icons/cloudy.gif')"
                    },
                    {
                        summary: "partly-cloudy-day",
                        image: "url('icons/partlyCloudyDay.gif')"
                    },
                    {
                        summary: "partly-cloudy-night",
                        image: "url('icons/partlyCloudyNight.gif')"
                    },

                ];
                icons.forEach(function (type) {
                    if(data.daily.data[2].icon === type.summary){
                        $('.icon3').attr('src',type.image);
                    }
                });
                backgrounds.forEach(function (type) {
                    if(data.daily.data[2].icon === type.summary){
                        $('#card3').css('background-image',type.image);
                    }
                });
            });
            weather.fail(function () {
                console.log("try again")
            })
        }

        genWeatherToday();
        genWeatherTomorrow();
        genWeatherDayAfterTomorrow();


    });
</script>
</body>
</html>